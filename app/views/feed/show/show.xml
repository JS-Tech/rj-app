<Page loaded="loaded">
  <Page.actionBar>
    <Image src="res://logorjpr" width="40px"/>
  </Page.actionBar>
  <ScrollView>
    <StackLayout orientation="vertical" class="main">

      <Label text="{{ 'Commenter le post de ' + post.author }}" class="title" />
      
      <StackLayout orientation="vertical" class="post">
        <GridLayout rows="auto, *" columns="60, *" class="infos">
          <Label text="&#xE0C9;" row="0" col="0" class="material-font info-icon"/>
          <Label text="{{ post.author }}" row="0" col="1" class="author"/>
        </GridLayout>
        <label text="{{'Posté le ' + post.createdAtDate + ' à ' + post.createdAtTime }}" class="date"></label>
        <TextView editable="false" text="{{ post.message }}" editable="false" class="message" loaded="updateMessage" />
        <ActivityIndicator busy="{{ isLoading }}" />
      </StackLayout>

      <GridLayout columns="3*, *" rows="auto" visibility="{{ isSignedIn ? 'visible' : 'collapsed'}}">
        <TextView text="{{ comment.message }}" height="90" col="0" row="0" class="new-comment" hint="Votre commentaire"/>
        <Button text="&#xE163;" tap="newComment" class="submit material-font" col="1" row="0"/>
      </GridLayout>
      <label text="Connectez-vous pour commenter" visibility="{{ isSignedIn ? 'collapsed' : 'visible'}}" class="connect"/>

      <Repeater items="{{ comments }}">
          <Repeater.itemTemplate>

            <StackLayout orientation="vertical" class="comment">
              <GridLayout rows="auto" columns="auto, auto, *, auto" class="infos-comment">
                <Button text="&#xE150;" row="0" col="0" class="material-font action" tap="editComment" visibility="{{ canEdit ? 'visible' : 'collapse' }}"/>
                <Button text="&#xE15C;" row="0" col="1" class="material-font action" commentId="{{ id }}" tap="deleteComment" visibility="{{ canEdit ? 'visible' : 'collapse' }}"/>
                <label text="{{ author }}" row="0" col="2" class="author-comment"></label>
                <label text="&#xE0B9;" row="0" col="3" class="material-font info-icon-comment"/>
              </GridLayout>
              <label text="{{'Posté le ' + createdAtDate + ' à ' + createdAtTime }}" row="1" col="1" class="date"></label>
              <StackLayout orientation="vertical">
                <TextView id="comment" editable="false" commentId="{{ id }}" text="{{ message }}" class="comment-message" />
              </StackLayout>

          </StackLayout>
        </Repeater.itemTemplate>
    </Repeater>
              
    </StackLayout>
    </ScrollView>
</Page>
